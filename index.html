<html lang="en-us">
<head>
  <script src="https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/1.9.0/js/okta-sign-in.min.js" type="text/javascript"></script>
  <link href="https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/1.9.0/css/okta-sign-in.min.css" type="text/css" rel="stylesheet">
  <!-- Optional, customizable css theme options. Link your own customized copy of this file or override styles in-line -->
  <link href="https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/1.9.0/css/okta-theme.css" type="text/css" rel="stylesheet">
</head>
<body>
<script>
signInWidget = new OktaSignIn(signInWidgetConfig);
function widgetSuccessCallback(res) {
  var key = '';
  if (res[0]) {
    key = Object.keys(res[0])[0];
    signInWidget.tokenManager.add(key, res[0]);
  }
  if (res[1]) {
    key = Object.keys(res[1])[0];
    signInWidget.tokenManager.add(key, res[1]);
  }
  if (res.status === 'SUCCESS') {
    var token = signInWidget.tokenManager.get(key);
    console.log("Logged in to Okta and issued token:");
    console.log(token);
    console.log("Reload this page to start over.");
    alert("Logged in! Check your developer console for details");
  }
}
function widgetErrorCallback (err) {
}
</script>
<div id="widget-container"></div>

<script>
  var orgUrl = 'https://okta2.crownight.com';
  var signIn = new OktaSignIn({baseUrl: 'https://okta2.crownight.com'});
  var str = decodeURIComponent(window.location.href);
  var redirectUrl = str.substr(str.indexOf("?fromURI=") + 9);
  signIn.renderEl({
    el: '#widget-container'
  }, function success(res) {
    if (res.status === 'SUCCESS') {
      console.log('You might be already logged in', res.session.token)}
      else { console.log('Relog, man!', res.session.token);
        if (str.includes("?fromURI")) {
         res.session.setCookieAndRedirect(redirectUrl); }
        else {res.session.setCookieAndRedirect(orgUrl);}

    // The user can be in another authentication state that requires further action.
    // For more information about these states, see:
    //   https://github.com/okta/okta-signin-widget#rendereloptions-success-error
    }
  });
</script>
</script>
  </body>
</html>
